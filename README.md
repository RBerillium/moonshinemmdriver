В данном проекте используется .data хук на необходимые системные рутины напрямую. Возможность использования некоторых функций обуславливается тем, что модуль Win32u сохраняет значения регистров при смене контекста на kernel, что позволяет передать до 4 параметров без каких либо проблем, даже если сама функция не подразумевает передачи этих самых параметров.
В случае же с MmCopyVirtualMemory, была найдена функция, которая передаёт все 7 параметров без изменений. 
Ключевое отличие от типичных .data hook драйверов является полное отсутствие обработчика, что позволяет полностью вычистить выделенный пул памяти после загрузки, которая подразумевает под собой manual mapping, а также то, что указатель ведёт в подписанную область. При анализе стека путём stackwalking не детектируется, а также не имеет выделенного пула памяти.
